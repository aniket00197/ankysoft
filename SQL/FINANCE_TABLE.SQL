-- INCOME TYPE TABLE
ALTER TABLE INCOME_TYPE
DROP CONSTRAINT FK_USERID

select * from application.userinfo

DROP TABLE INCOME_TYPE

CREATE TABLE INCOME_TYPE
(
ID INT PRIMARY KEY,
INCOME_SOURCE VARCHAR(100) NOT NULL UNIQUE,
TYPE VARCHAR(100) NOT NULL,
COMPANY_NAME VARCHAR(100),
USERID NUMBER NOT NULL,
CONSTRAINT FK_USERID FOREIGN KEY(USERID) REFERENCES APPLICATION.USERINFO(USERID),
CONSTRAINT un_income_type_ie_ty_ui UNIQUE(INCOME_SOURCE,TYPE,USERID)
);

-- WALLET TABLE
ALTER TABLE WALLET
DROP CONSTRAINT fk_wallet_userid

DROP TABLE WALLET

CREATE TABLE WALLET
(
ID INT PRIMARY KEY,
WALLET_NAME VARCHAR(100) NOT NULL,
TYPE VARCHAR(100) NOT NULL,
AMOUNT INT DEFAULT 0,
USERID NUMBER NOT NULL,
UPDATE_DATE DATE NOT NULL,
CONSTRAINT fk_wallet_userid FOREIGN KEY(USERID) REFERENCES APPLICATION.USERINFO(USERID),
CONSTRAINT un_wallet_wn_ty_ui UNIQUE(WALLET_NAME,TYPE,USERID)
);

-- INCOME MANAGER
ALTER TABLE INCOME_MANAGER
DROP CONSTRAINT fk_incomemanager_incometypeid
DROP CONSTRAINT fk_incomemanager_wallettypeid
DROP CONSTRAINT fk_incomemanager_userid

DROP TABLE INCOME_MANAGER

CREATE TABLE INCOME_MANAGER
(
ID INT PRIMARY KEY,
TRANS_DATE DATE NOT NULL,
AMOUNT INT DEFAULT 0 NOT NULL ,
INCOME_TYPE_ID INT NOT NULL,
WALLET_TYPE_ID INT NOT NULL,
TAGS VARCHAR(250),
COMMENTS VARCHAR(250),
CREATED_DATE DATE NOT NULL,
USERID NUMBER NOT NULL,
CONSTRAINT fk_incomemanager_incometypeid FOREIGN KEY(INCOME_TYPE_ID) REFERENCES INCOME_TYPE(ID),
CONSTRAINT fk_incomemanager_wallettypeid FOREIGN KEY(WALLET_TYPE_ID) REFERENCES WALLET(ID),
CONSTRAINT fk_incomemanager_userid FOREIGN KEY(USERID) REFERENCES APPLICATION.USERINFO(USERID)
);

-- EXPENSE CATEGORY TABLE
ALTER TABLE EXPENSE_CATEGORY
DROP CONSTRAINT pk_expense_category_userid
DROP TABLE EXPENSE_CATEGORY
CREATE TABLE EXPENSE_CATEGORY
(
CATID INT PRIMARY KEY,
CATEGORYNAME VARCHAR(250) NOT NULL,
CREATED_DATE DATE NOT NULL,
USERID NUMBER NOT NULL,
CONSTRAINT pk_expense_category_userid FOREIGN KEY(USERID) REFERENCES APPLICATION.USERINFO(USERID),
CONSTRAINT un_expense_cat_catn_ui UNIQUE(CATEGORYNAME,USERID)
);

-- EXPENSE SUBCATEORY TABLE
ALTER TABLE EXPENSE_SUBCATEGORY
DROP CONSTRAINT pk_expense_subcat_catid
DROP TABLE EXPENSE_SUBCATEGORY
CREATE TABLE EXPENSE_SUBCATEGORY
(
SUBCATID INT PRIMARY KEY,
SUBCATEGORYNAME VARCHAR(50) NOT NULL,
CATEGORYID INT NOT NULL,
CREATEDDATE DATE,
CONSTRAINT pk_expense_subcat_catid FOREIGN KEY(CATEGORYID) REFERENCES EXPENSE_CATEGORY(CATID),
CONSTRAINT un_expense_subcat_name_catid UNIQUE(SUBCATEGORYNAME,CATEGORYID)
);

-- EXPENSE MANAGER TABLE
ALTER TABLE EXPENSE_MANAGER
DROP CONSTRAINT pk_expense_manager_catid
DROP CONSTRAINT pk_expense_manager_subcatid
DROP CONSTRAINT pk_expense_manager_userid

DROP TABLE EXPENSE_MANAGER
CREATE TABLE EXPENSE_MANAGER
(
EXPENSEID INT PRIMARY KEY,
TRANS_DATE DATE NOT NULL,
AMOUNT INT DEFAULT 0 NOT NULL,
CATEGORY_ID INT NOT NULL,
SUBCATEGORY_ID INT NOT NULL,
WALLET_TYPE_ID INT NOT NULL,
TAGS VARCHAR(250),
COMMENTS VARCHAR(250),
NECESSORY_UNNECESSORY_FLAG INT NOT NULL,
USERID NUMBER NOT NULL,
CREATEDDATE DATE,
CONSTRAINT pk_expense_manager_catid FOREIGN KEY(CATEGORY_ID) REFERENCES EXPENSE_CATEGORY(CATID),
CONSTRAINT pk_expense_manager_subcatid FOREIGN KEY(SUBCATEGORY_ID) REFERENCES EXPENSE_SUBCATEGORY(SUBCATID),
CONSTRAINT pk_expense_manager_userid FOREIGN KEY(USERID) REFERENCES APPLICATION.USERINFO(USERID)
)
